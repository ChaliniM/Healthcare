{% extends "base.html" %}
{% block title %}Appointments{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h4>Appointments</h4>
  <a href="{{ url_for('add_appointment') }}" class="btn btn-success btn-sm">Schedule Appointment</a>
</div>

<table class="table table-sm">
  <thead><tr><th>ID</th><th>Patient</th><th>Datetime</th><th>Doctor</th><th>Reason</th><th>Status</th><th>Actions</th></tr></thead>
  <tbody>
    {% for a in appointments %}
      <tr>
        <td>{{ a['id'] }}</td>
        <td>{{ a['patient_name'] }}</td>
        <td>{{ a['datetime'] }}</td>
        <td>{{ a['doctor'] or '-' }}</td>
        <td>{{ a['reason'] or '-' }}</td>
        <td>{{ a['status'] }}</td>
        <td>
          <form method="post" action="{{ url_for('update_appointment_status', aid=a['id']) }}" style="display:inline">
            <select name="status" class="form-select form-select-sm d-inline-block" style="width:130px; display:inline-block;">
              <option value="scheduled" {% if a['status']=='scheduled' %}selected{% endif %}>Scheduled</option>
              <option value="completed" {% if a['status']=='completed' %}selected{% endif %}>Completed</option>
              <option value="cancelled" {% if a['status']=='cancelled' %}selected{% endif %}>Cancelled</option>
            </select>
            <button class="btn btn-sm btn-primary">Update</button>
          </form>
          <form method="post" action="{{ url_for('delete_appointment', aid=a['id']) }}" style="display:inline" onsubmit="return confirm('Delete appointment?');">
            <button class="btn btn-sm btn-danger">Delete</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
